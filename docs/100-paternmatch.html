<!DOCTYPE html>
<html lang="en" prefix="og: https://ogp.me/ns#" data-bs-theme="auto">

<head>
    <title>Ultimate .NET cheat sheet - Pattern matching</title>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <link rel="icon" href="favicon.ico" type="image/x-icon" />
    <link rel="apple-touch-icon" sizes="180x180" href="pwa/apple-touch-icon.png">
    <link rel="manifest" href="manifest.json">
    <link href="bootstrap.min.css" rel="stylesheet" type="text/css">
    <link rel="stylesheet" href="prism.css" type="text/css">
    <link rel="stylesheet" href="style.css" type="text/css">
    <script src="prism.js" type="text/javascript"></script>
    <script src="script.js" type="text/javascript"></script>

    <!--OpenGraph meta-->
    <meta property="og:url" content="https://webmaster442.github.io/ultimatedotnetcheatsheet/">
    <meta property="og:type" content="website">
    <meta property="og:title" content="Ultimate .NET cheat sheet - Pattern matching">
    <meta property="og:locale" content="en_US">
    <meta property="og:image" content="https://webmaster442.github.io/ultimatedotnetcheatsheet/header.webp">
    <meta property="og:image:type" content="image/webp" />
    <meta property="og:image:width" content="945" />
    <meta property="og:image:height" content="1134" />
    <meta property="og:description"
        content="Welcome to the Ultimate .NET Cheatsheet! This project aims to provide a comprehensive and useful guide for developers working with C# on a daily basis. Whether you're a beginner getting started with C# or an experienced developer looking for quick references, this cheatsheet has got you covered.">
</head>

<body>
    <svg xmlns="http://www.w3.org/2000/svg" class="d-none">
        <symbol id="check2" viewBox="0 0 16 16">
            <path
                d="M13.854 3.646a.5.5 0 0 1 0 .708l-7 7a.5.5 0 0 1-.708 0l-3.5-3.5a.5.5 0 1 1 .708-.708L6.5 10.293l6.646-6.647a.5.5 0 0 1 .708 0z" />
        </symbol>
        <symbol id="circle-half" viewBox="0 0 16 16">
            <path d="M8 15A7 7 0 1 0 8 1v14zm0 1A8 8 0 1 1 8 0a8 8 0 0 1 0 16z" />
        </symbol>
        <symbol id="moon-stars-fill" viewBox="0 0 16 16">
            <path
                d="M6 .278a.768.768 0 0 1 .08.858 7.208 7.208 0 0 0-.878 3.46c0 4.021 3.278 7.277 7.318 7.277.527 0 1.04-.055 1.533-.16a.787.787 0 0 1 .81.316.733.733 0 0 1-.031.893A8.349 8.349 0 0 1 8.344 16C3.734 16 0 12.286 0 7.71 0 4.266 2.114 1.312 5.124.06A.752.752 0 0 1 6 .278z" />
            <path
                d="M10.794 3.148a.217.217 0 0 1 .412 0l.387 1.162c.173.518.579.924 1.097 1.097l1.162.387a.217.217 0 0 1 0 .412l-1.162.387a1.734 1.734 0 0 0-1.097 1.097l-.387 1.162a.217.217 0 0 1-.412 0l-.387-1.162A1.734 1.734 0 0 0 9.31 6.593l-1.162-.387a.217.217 0 0 1 0-.412l1.162-.387a1.734 1.734 0 0 0 1.097-1.097l.387-1.162zM13.863.099a.145.145 0 0 1 .274 0l.258.774c.115.346.386.617.732.732l.774.258a.145.145 0 0 1 0 .274l-.774.258a1.156 1.156 0 0 0-.732.732l-.258.774a.145.145 0 0 1-.274 0l-.258-.774a1.156 1.156 0 0 0-.732-.732l-.774-.258a.145.145 0 0 1 0-.274l.774-.258c.346-.115.617-.386.732-.732L13.863.1z" />
        </symbol>
        <symbol id="sun-fill" viewBox="0 0 16 16">
            <path
                d="M8 12a4 4 0 1 0 0-8 4 4 0 0 0 0 8zM8 0a.5.5 0 0 1 .5.5v2a.5.5 0 0 1-1 0v-2A.5.5 0 0 1 8 0zm0 13a.5.5 0 0 1 .5.5v2a.5.5 0 0 1-1 0v-2A.5.5 0 0 1 8 13zm8-5a.5.5 0 0 1-.5.5h-2a.5.5 0 0 1 0-1h2a.5.5 0 0 1 .5.5zM3 8a.5.5 0 0 1-.5.5h-2a.5.5 0 0 1 0-1h2A.5.5 0 0 1 3 8zm10.657-5.657a.5.5 0 0 1 0 .707l-1.414 1.415a.5.5 0 1 1-.707-.708l1.414-1.414a.5.5 0 0 1 .707 0zm-9.193 9.193a.5.5 0 0 1 0 .707L3.05 13.657a.5.5 0 0 1-.707-.707l1.414-1.414a.5.5 0 0 1 .707 0zm9.193 2.121a.5.5 0 0 1-.707 0l-1.414-1.414a.5.5 0 0 1 .707-.707l1.414 1.414a.5.5 0 0 1 0 .707zM4.464 4.465a.5.5 0 0 1-.707 0L2.343 3.05a.5.5 0 1 1 .707-.707l1.414 1.414a.5.5 0 0 1 0 .708z" />
        </symbol>
        <symbol id="github" viewBox="0 0 24 24">
            <path
                d="M12,2A10,10 0 0,0 2,12C2,16.42 4.87,20.17 8.84,21.5C9.34,21.58 9.5,21.27 9.5,21C9.5,20.77 9.5,20.14 9.5,19.31C6.73,19.91 6.14,17.97 6.14,17.97C5.68,16.81 5.03,16.5 5.03,16.5C4.12,15.88 5.1,15.9 5.1,15.9C6.1,15.97 6.63,16.93 6.63,16.93C7.5,18.45 8.97,18 9.54,17.76C9.63,17.11 9.89,16.67 10.17,16.42C7.95,16.17 5.62,15.31 5.62,11.5C5.62,10.39 6,9.5 6.65,8.79C6.55,8.54 6.2,7.5 6.75,6.15C6.75,6.15 7.59,5.88 9.5,7.17C10.29,6.95 11.15,6.84 12,6.84C12.85,6.84 13.71,6.95 14.5,7.17C16.41,5.88 17.25,6.15 17.25,6.15C17.8,7.5 17.45,8.54 17.35,8.79C18,9.5 18.38,10.39 18.38,11.5C18.38,15.32 16.04,16.16 13.81,16.41C14.17,16.72 14.5,17.33 14.5,18.26C14.5,19.6 14.5,20.68 14.5,21C14.5,21.27 14.66,21.59 15.17,21.5C19.14,20.16 22,16.42 22,12A10,10 0 0,0 12,2Z" />
        </symbol>
    </svg>

    <nav id="nav" class="navbar navbar-expand-sm navbar-dark bg-dark fixed-top">
        <div class="container-fluid">
            <a class="navbar-brand" href="index.html">
                <img src="pwa/i-192.png" height="40px"> version: 24-09-16</a>
            <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#mynavbar">
                <span class="navbar-toggler-icon"></span>
            </button>
            <div class="collapse navbar-collapse" id="mynavbar">
                <ul class="navbar-nav me-auto">
                    <div id="toclinks">
                        <ul><li><a href="https://webmaster442.github.io/ultimatedotnetcheatsheet/010-basiccommands.html">Dotnet CLI</a></li><li><a href="https://webmaster442.github.io/ultimatedotnetcheatsheet/020-project.html">Project XML Settings</a></li><li><a href="https://webmaster442.github.io/ultimatedotnetcheatsheet/030-powershell.html">Usefull Powershell commands & scripts</a></li><li><a href="https://webmaster442.github.io/ultimatedotnetcheatsheet/035-csharpbasics.html">C# basics</a></li><li><a href="https://webmaster442.github.io/ultimatedotnetcheatsheet/040-types.html">Basic type system</a></li><li><a href="https://webmaster442.github.io/ultimatedotnetcheatsheet/045-type-interfaces.html">Important interfaces for types</a></li><li><a href="https://webmaster442.github.io/ultimatedotnetcheatsheet/060-strings.html">Strings</a></li><li><a href="https://webmaster442.github.io/ultimatedotnetcheatsheet/070-exceptions.html">Exceptions</a></li><li><a href="https://webmaster442.github.io/ultimatedotnetcheatsheet/075-generics.html">Generics</a></li><li><a href="https://webmaster442.github.io/ultimatedotnetcheatsheet/080-collections.html">Collections</a></li><li><a href="https://webmaster442.github.io/ultimatedotnetcheatsheet/090-linq.html">LINQ</a></li><li><a href="https://webmaster442.github.io/ultimatedotnetcheatsheet/100-paternmatch.html">Pattern matching</a></li><li><a href="https://webmaster442.github.io/ultimatedotnetcheatsheet/105-tasks.html">Tasks</a></li><li><a href="https://webmaster442.github.io/ultimatedotnetcheatsheet/110-io.html">I/O</a></li><li><a href="https://webmaster442.github.io/ultimatedotnetcheatsheet/111-attribs.html">Attributes</a></li><li><a href="https://webmaster442.github.io/ultimatedotnetcheatsheet/112-serialization.html">Serialization</a></li><li><a href="https://webmaster442.github.io/ultimatedotnetcheatsheet/114-validation.html">Object validation</a></li><li><a href="https://webmaster442.github.io/ultimatedotnetcheatsheet/120-crypto.html">Cryptography</a></li><li><a href="https://webmaster442.github.io/ultimatedotnetcheatsheet/130-reflection.html">Reflection</a></li><li><a href="https://webmaster442.github.io/ultimatedotnetcheatsheet/140-ui.html">UI</a></li><li><a href="https://webmaster442.github.io/ultimatedotnetcheatsheet/150-nuget.html">Useful NuGet packages</a></li></ul>
                    </div>
                </ul>
                <div class="d-flex">
                    <ul class="navbar-nav me-auto">
                        <li class="nav-item">
                            <a href="https://github.com/webmaster442/ultimatedotnetcheatsheet" target="_blank"
                                title="Fork me on github">
                                <svg>
                                    <use href="#github"></use>
                                </svg>
                            </a>
                        </li>
                    </ul>
                </div>
            </div>
        </div>
    </nav>


    <div id="main" class="container-fluid" style="margin-top:150px">
        <div class="row">
            <div class="col-xl-10 text-justify" id="content">
                <h1 id="pattern-matching">Pattern matching</h1>
<h2 id="discard-pattern">Discard pattern</h2>
<p>The discard pattern can be used to match any expression, including <code>null</code>. It's represented by the <code>_</code> symbol.</p>
<pre><code class="language-csharp">bool isFloatingPointNumber(string input)
{
    //the out value of the conversion is discarded
    return double.TryParse(input, out double _);
}
</code></pre>
<h2 id="var-pattern">var pattern</h2>
<p>The <code>var</code> pattern can be used to match any expression, including <code>null</code>, and assign its result to a new local variable:</p>
<pre><code class="language-csharp">bool isFloatingPointNumber(string input)
{
    return double.TryParse(input, out var _);
}
</code></pre>
<h2 id="declaration-and-type-patterns">Declaration and type patterns</h2>
<pre><code class="language-csharp">object greeting = &quot;Hello, World!&quot;;
if (greeting is string message)
{
	//greeting is a string and casted to message variable
}
</code></pre>
<p>A declaration pattern with type T matches an expression when an expression result is non-null and any of the following conditions are true:</p>
<ul>
<li>The run-time type of an expression result is T.</li>
<li>The run-time type of an expression result derives from type T, implements interface T, or another implicit reference conversion exists from it to T.</li>
</ul>
<p><strong>Null checking:</strong></p>
<pre><code class="language-csharp">if (input is not null)
{
    // ...
}
</code></pre>
<p><strong>Type checking in switch:</strong></p>
<pre><code class="language-csharp">public abstract class Vehicle {}
public class Car : Vehicle {}
public class Truck : Vehicle {}

public static class TollCalculator
{
    public static decimal CalculateToll(this Vehicle vehicle) =&gt; vehicle switch
    {
        Car _ =&gt; 2.00m,
        Truck _ =&gt; 7.50m,
        null =&gt; throw new ArgumentNullException(nameof(vehicle)),
        _ =&gt; throw new ArgumentException(&quot;Unknown type of a vehicle&quot;, nameof(vehicle)),
    };
}
</code></pre>
<h2 id="constant-pattern">Constant pattern</h2>
<pre><code class="language-csharp">public static decimal GetGroupTicketPrice(int visitorCount) =&gt; visitorCount switch
{
    1 =&gt; 12.0m,
    2 =&gt; 20.0m,
    3 =&gt; 27.0m,
    0 =&gt; 0.0m,
    _ =&gt; throw new ArgumentException($&quot;Not supported number of visitors: {visitorCount}&quot;, nameof(visitorCount)),
};
</code></pre>
<p>In a constant pattern, you can use any constant expression, such as integers, floating-point numbers, char, string, boolean, enums, name of a declared const field or local and null. Note: <code>Span&lt;char&gt;</code> or <code>ReadOnlySpan&lt;char&gt;</code> can also be matched in the constant pattern, but in C# 11 and later versions</p>
<h2 id="relational-patterns">Relational patterns</h2>
<pre><code class="language-csharp">static string Classify(double measurement) =&gt; measurement switch
{
    &lt; -4.0 =&gt; &quot;Too low&quot;,
    &gt; 10.0 =&gt; &quot;Too high&quot;,
    double.NaN =&gt; &quot;Unknown&quot;,
    _ =&gt; &quot;Acceptable&quot;,
};
</code></pre>
<p>In a relational pattern, you can use any of the relational operators <code>&lt;</code>, <code>&gt;</code>, <code>&lt;=</code>, or <code>&gt;=</code>. The right-hand part of a relational pattern must be a constant expression. For the constant expression, the constant pattern limitations apply.</p>
<h2 id="logical-patterns">Logical patterns</h2>
<pre><code class="language-csharp">static string Classify(double measurement) =&gt; measurement switch
{
    &lt; -40.0 =&gt; &quot;Too low&quot;,
    &gt;= -40.0 and &lt; 0 =&gt; &quot;Low&quot;,
    &gt;= 0 and &lt; 10.0 =&gt; &quot;Acceptable&quot;,
    &gt;= 10.0 and &lt; 20.0 =&gt; &quot;High&quot;,
    &gt;= 20.0 =&gt; &quot;Too high&quot;,
    double.NaN =&gt; &quot;Unknown&quot;,
};
</code></pre>
<pre><code class="language-csharp">static string GetCalendarSeason(DateTime date) =&gt; date.Month switch
{
    3 or 4 or 5 =&gt; &quot;spring&quot;,
    6 or 7 or 8 =&gt; &quot;summer&quot;,
    9 or 10 or 11 =&gt; &quot;autumn&quot;,
    12 or 1 or 2 =&gt; &quot;winter&quot;,
    _ =&gt; throw new ArgumentOutOfRangeException(nameof(date), $&quot;Date with unexpected month: {date.Month}.&quot;),
};
</code></pre>
<p>Precedence: <code>not</code>, <code>and</code>, <code>or</code>. To explicitly specify the precedence, use parentheses:</p>
<pre><code class="language-csharp">static bool IsLetter(char c) =&gt; c is (&gt;= 'a' and &lt;= 'z') or (&gt;= 'A' and &lt;= 'Z');
</code></pre>
<h2 id="property-pattern">Property Pattern</h2>
<pre><code class="language-csharp">static bool IsConferenceDay(DateTime date) =&gt; date is { Year: 2020, Month: 5, Day: 19 or 20 or 21 };
</code></pre>
<p>A property pattern matches an expression when an expression result is non-null and every nested pattern matches the corresponding property or field of the expression result. It can be combined with run-time type check and variable declaration:</p>
<pre><code class="language-csharp">static string TakeFive(object input) =&gt; input switch
{
    string { Length: &gt;= 5 } s =&gt; s.Substring(0, 5),
    string s =&gt; s,

    ICollection&lt;char&gt; { Count: &gt;= 5 } symbols =&gt; new string(symbols.Take(5).ToArray()),
    ICollection&lt;char&gt; symbols =&gt; new string(symbols.ToArray()),

    null =&gt; throw new ArgumentNullException(nameof(input)),
    _ =&gt; throw new ArgumentException(&quot;Not supported input type.&quot;),
};
</code></pre>
<h2 id="positional-pattern">Positional pattern</h2>
<p>You use a positional pattern to deconstruct an expression result and match the resulting values against the corresponding nested patterns.</p>
<pre><code class="language-csharp">public readonly struct Point
{
    public int X { get; }
    public int Y { get; }

    public Point(int x, int y) =&gt; (X, Y) = (x, y);
    public void Deconstruct(out int x, out int y) =&gt; (x, y) = (X, Y);
}

static string Classify(Point point) =&gt; point switch
{
    (0, 0) =&gt; &quot;Origin&quot;,
    (1, 0) =&gt; &quot;positive X basis end&quot;,
    (0, 1) =&gt; &quot;positive Y basis end&quot;,
    _ =&gt; &quot;Just a point&quot;,
};
</code></pre>
<p>At the preceding example, the type of an expression contains the Deconstruct method, which is used to deconstruct an expression result. You can also match expressions of tuple types against positional patterns. In that way, you can match multiple inputs against various patterns:</p>
<pre><code class="language-csharp">static decimal GetGroupTicketPriceDiscount(int groupSize, DateTime visitDate)
    =&gt; (groupSize, visitDate.DayOfWeek) switch
    {
        (&lt;= 0, _) =&gt; throw new ArgumentException(&quot;Group size must be positive.&quot;),
        (_, DayOfWeek.Saturday or DayOfWeek.Sunday) =&gt; 0.0m,
        (&gt;= 5 and &lt; 10, DayOfWeek.Monday) =&gt; 20.0m,
        (&gt;= 10, DayOfWeek.Monday) =&gt; 30.0m,
        (&gt;= 5 and &lt; 10, _) =&gt; 12.0m,
        (&gt;= 10, _) =&gt; 15.0m,
        _ =&gt; 0.0m,
    };
</code></pre>
<h2 id="list-patterns">List patterns</h2>
<pre><code class="language-csharp">int[] numbers = { 1, 2, 3 };

numbers is [1, 2, 3]; //true
numbers is [1, 2, 4]; //false
numbers is [1, 2, 3, 4]; //false
numbers is [0 or 1, &lt;= 2, &gt;= 3]; //true
</code></pre>
<p>To match elements only at the start or/and the end of an input sequence, use the slice pattern (<code>..</code>);  A slice pattern matches zero or more elements. You can use at most one slice pattern in a list pattern. The slice pattern can only appear in a list pattern.</p>
<pre><code class="language-csharp">new[] { 1, 2, 3, 4, 5 } is [&gt; 0, &gt; 0, ..];  // True
new[] { 1, 1 } is [_, _, ..];  // True
new[] { 0, 1, 2, 3, 4 } is [&gt; 0, &gt; 0, ..];  // False
new[] { 1 } is [1, 2, ..];  // False

new[] { 1, 2, 3, 4 } is [.., &gt; 0, &gt; 0];  // True
new[] { 2, 4 } is [.., &gt; 0, 2, 4];  // False
new[] { 2, 4 } is [.., 2, 4];  // True

new[] { 1, 2, 3, 4 } is [&gt;= 0, .., 2 or 4];  // True
new[] { 1, 0, 0, 1 } is [1, 0, .., 0, 1];  // True
new[] { 1, 0, 1 } is [1, 0, .., 0, 1];  // False
</code></pre>

            </div>
            <div class="col-xl-2">
                <div class="card" id="pagenav">
                    <h4 class="card-title">On this page</h4>
                </div>
            </div>
        </div>

    </div>

    <div class="dropdown position-fixed bottom-0 end-0 mb-3 me-3 bd-mode-toggle">
        <button class="btn btn-bd-primary py-2 dropdown-toggle d-flex align-items-center" id="bd-theme" type="button"
            aria-expanded="false" data-bs-toggle="dropdown" aria-label="Toggle theme (auto)">
            <svg class="bi my-1 theme-icon-active" width="1em" height="1em">
                <use href="#circle-half"></use>
            </svg>
            <span class="visually-hidden" id="bd-theme-text">Toggle theme</span>
        </button>
        <ul class="dropdown-menu dropdown-menu-end shadow" aria-labelledby="bd-theme-text">
            <li>
                <button type="button" class="dropdown-item d-flex align-items-center" data-bs-theme-value="light"
                    aria-pressed="false">
                    <svg class="bi me-2 opacity-50" width="1em" height="1em">
                        <use href="#sun-fill"></use>
                    </svg>
                    Light
                    <svg class="bi ms-auto d-none" width="1em" height="1em">
                        <use href="#check2"></use>
                    </svg>
                </button>
            </li>
            <li>
                <button type="button" class="dropdown-item d-flex align-items-center" data-bs-theme-value="dark"
                    aria-pressed="false">
                    <svg class="bi me-2 opacity-50" width="1em" height="1em">
                        <use href="#moon-stars-fill"></use>
                    </svg>
                    Dark
                    <svg class="bi ms-auto d-none" width="1em" height="1em">
                        <use href="#check2"></use>
                    </svg>
                </button>
            </li>
            <li>
                <button type="button" class="dropdown-item d-flex align-items-center active" data-bs-theme-value="auto"
                    aria-pressed="true">
                    <svg class="bi me-2 opacity-50" width="1em" height="1em">
                        <use href="#circle-half"></use>
                    </svg>
                    Auto
                    <svg class="bi ms-auto d-none" width="1em" height="1em">
                        <use href="#check2"></use>
                    </svg>
                </button>
            </li>
        </ul>
    </div>

    <button id="navigate-top" onclick="scrollToTop()" type="button" title="Scroll to top">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24">
            <path d="M13,20H11V8L5.5,13.5L4.08,12.08L12,4.16L19.92,12.08L18.5,13.5L13,8V20Z" />
        </svg>
    </button>

    <script src="bootstrap.bundle.min.js" type="text/javascript"></script>

</body>

</html>
